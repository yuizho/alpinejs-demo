<html>
  <head>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.15.4/dist/cdn.min.js"
    ></script>
  </head>
  <body>
    <h1>x-init</h1>
    x-initで初期化処理を実行できる。
    <div
      x-data="{ dogUrl: '' }"
      x-init="dogUrl = await fetch('https://dog.ceo/api/breeds/image/random').then(res => res.json()).then(data => data.message)"
    >
      <template x-if="dogUrl">
        <img height="500" :src="dogUrl" alt="A Random Dog" />
      </template>
      <template x-if="!dogUrl">
        <span>Loading...</span>
      </template>
    </div>

    <h2>$nextTick</h2>
    <div
      x-init="$nextTick(() => { console.log('After rendering by Alpine.js') })"
    >
      $nexTickを使うと完全にレンダリングが終わったあとに処理を実行できる。ReactのuseEffectに似ている。
    </div>

    <h2>Auto-evaluate init() method</h2>
    <div
      x-data="{
          init() {
              console.log('I am called first')
          }
      }"
      x-init="console.log('I am called second')"
    >
      x-data内のinit()は自動的に実行される。init()のほうがx-initよりも先に実行される。
    </div>
  </body>
</html>
